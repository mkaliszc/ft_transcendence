CREATE DATABASE IF NOT EXISTS ${MARIADB_DATABASE};

CREATE USER IF NOT EXISTS '${MARIADB_USER}'@'%' IDENTIFIED BY '${MARIADB_PASSWORD}';
GRANT ALL PRIVILEGES ON ${MARIADB_DATABASE}.* TO '${MARIADB_USER}'@'%';

ALTER USER 'root'@'localhost' IDENTIFIED BY '${MARIADB_ROOT_PASSWORD}';
FLUSH PRIVILEGES;
USE ${MARIADB_DATABASE};

-- Table USERS
CREATE TABLE IF NOT EXISTS USERS (
    user_id INT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(20) NOT NULL UNIQUE,
    email_adress VARCHAR(255) NOT NULL UNIQUE,
    hashed_password VARCHAR(255) NOT NULL,
    number_of_matches INT DEFAULT 0,
    number_of_win INT DEFAULT 0,
    number_of_lose INT DEFAULT 0,
    creation_date DATE DEFAULT CURRENT_DATE,
    last_update DATE DEFAULT CURRENT_DATE,
    avatar MEDIUMTEXT DEFAULT 'data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4QC8RXhpZgAASUkqAAgAAAAGABIBAwABAAAAAQAAABoBBQABAAAAVgAAABsBBQABAAAAXgAAACgBAwABAAAAAgAAABMCAwABAAAAAQAAAGmHBAABAAAAZgAAAAAAAABgAAAAAQAAAGAAAAABAAAABgAAkAcABAAAADAyMTABkQcABAAAAAECAwAAoAcABAAAADAxMDABoAMAAQAAAP//AAACoAMAAQAAAJYAAAADoAMAAQAAAJYAAAAAAAAA/+EOO2h0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8APD94cGFja2V0IGJlZ2luPSfvu78nIGlkPSdXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQnPz4KPHg6eG1wbWV0YSB4bWxuczp4PSdhZG9iZTpuczptZXRhLyc+CjxyZGY6UkRGIHhtbG5zOnJkZj0naHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyc+CgogPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9JycKICB4bWxuczpBdHRyaWI9J2h0dHA6Ly9ucy5hdHRyaWJ1dGlvbi5jb20vYWRzLzEuMC8nPgogIDxBdHRyaWI6QWRzPgogICA8cmRmOlNlcT4KICAgIDxyZGY6bGkgcmRmOnBhcnNlVHlwZT0nUmVzb3VyY2UnPgogICAgIDxBdHRyaWI6Q3JlYXRlZD4yMDI1LTA2LTIwPC9BdHRyaWI6Q3JlYXRlZD4KICAgICA8QXR0cmliOkV4dElkPjI3Njg2ZmJmLWI5ZWQtNGM3Yi1iZDI3LWM2ZTNhM2VjMmNjZjwvQXR0cmliOkV4dElkPgogICAgIDxBdHRyaWI6RmJJZD41MjUyNjU5MTQxNzk1ODA8L0F0dHJpYjpGYklkPgogICAgIDxBdHRyaWI6VG91Y2hUeXBlPjI8L0F0dHJpYjpUb3VjaFR5cGU+CiAgICA8L3JkZjpsaT4KICAgPC9yZGY6U2VxPgogIDwvQXR0cmliOkFkcz4KIDwvcmRmOkRlc2NyaXB0aW9uPgoKIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PScnCiAgeG1sbnM6ZGM9J2h0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvJz4KICA8ZGM6dGl0bGU+CiAgIDxyZGY6QWx0PgogICAgPHJkZjpsaSB4bWw6bGFuZz0neC1kZWZhdWx0Jz5EZXNpZ24gc2FucyB0aXRyZSAtIDE8L3JkZjpsaT4KICAgPC9yZGY6QWx0PgogIDwvZGM6dGl0bGU+CiA8L3JkZjpEZXNjcmlwdGlvbj4KCiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0nJwogIHhtbG5zOnBkZj0naHR0cDovL25zLmFkb2JlLmNvbS9wZGYvMS4zLyc+CiAgPHBkZjpBdXRob3I+XyBNaWxhbiBfPC9wZGY6QXV0aG9yPgogPC9yZGY6RGVzY3JpcHRpb24+CgogPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9JycKICB4bWxuczp4bXA9J2h0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8nPgogIDx4bXA6Q3JlYXRvclRvb2w+Q2FudmEgKFJlbmRlcmVyKSBkb2M9REFHcTZrU3Y0SXcgdXNlcj1VQUdvZGZWZ0JrbyBicmFuZD1CQUdvZFNjTS1TUSB0ZW1wbGF0ZT08L3htcDpDcmVhdG9yVG9vbD4KIDwvcmRmOkRlc2NyaXB0aW9uPgo8L3JkZjpSREY+CjwveDp4bXBtZXRhPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAo8P3hwYWNrZXQgZW5kPSd3Jz8+/9sAQwAGBAUGBQQGBgUGBwcGCAoQCgoJCQoUDg8MEBcUGBgXFBYWGh0lHxobIxwWFiAsICMmJykqKRkfLTAtKDAlKCko/9sAQwEHBwcKCAoTCgoTKBoWGigoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgo/8AAEQgAlgCWAwEiAAIRAQMRAf/EAB8AAAEFAQEBAQEBAAAAAAAAAAABAgMEBQYHCAkKC//EALUQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+v/EAB8BAAMBAQEBAQEBAQEAAAAAAAABAgMEBQYHCAkKC//EALURAAIBAgQEAwQHBQQEAAECdwABAgMRBAUhMQYSQVEHYXETIjKBCBRCkaGxwQkjM1LwFWJy0QoWJDThJfEXGBkaJicoKSo1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoKDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uLj5OXm5+jp6vLz9PX29/j5+v/aAAwDAQACEQMRAD8Aktl9quqtQWw4q6i183J+8fTz3EUYprHNSkVXbrW9MUY3HqlRXAwCKnjO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=',
    twoFA BOOLEAN DEFAULT FALSE,
    twoFA_secret VARCHAR(255) DEFAULT NULL,
    google_user BOOLEAN DEFAULT FALSE
) ENGINE=InnoDB;

-- Table MATCHES
CREATE TABLE IF NOT EXISTS MATCHES (
    match_id INT AUTO_INCREMENT PRIMARY KEY,
    game_duration TIME NOT NULL,
    match_date DATE DEFAULT CURRENT_DATE
) ENGINE=InnoDB;

-- Table USER_MATCH (relation entre USERS et MATCHES)
CREATE TABLE IF NOT EXISTS USER_MATCH (
    match_id INT,
    user_id INT,
    winner BOOLEAN DEFAULT FALSE,
    user_score INT NOT NULL CHECK (user_score >= 0),
    PRIMARY KEY (match_id, user_id),
    FOREIGN KEY (match_id) REFERENCES MATCHES(match_id) ON DELETE CASCADE,
    FOREIGN KEY (user_id) REFERENCES USERS(user_id) ON DELETE CASCADE
);

-- Table FRIENDSHIP
CREATE TABLE IF NOT EXISTS FRIENDSHIP (
    friendship_id INT AUTO_INCREMENT PRIMARY KEY,
    user_id1 INT,
    user_id2 INT,
    status VARCHAR(20) NOT NULL DEFAULT 'none',
    creation_date DATE DEFAULT CURRENT_DATE,
    last_update DATE DEFAULT CURRENT_DATE,
    FOREIGN KEY (user_id1) REFERENCES USERS(user_id) ON DELETE CASCADE,
    FOREIGN KEY (user_id2) REFERENCES USERS(user_id) ON DELETE CASCADE,
    CONSTRAINT unique_friendship UNIQUE (user_id1, user_id2),
    CHECK (user_id1 != user_id2)
) ENGINE=InnoDB;
